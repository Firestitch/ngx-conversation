<fs-dialog>
  <form fsForm [submit]="messageSend" #messageForm>
    <ng-container *ngIf="conversation">
      <app-conversation-header
        [conversationService]="conversationService"
        [conversation]="conversation"
        (conversationChange)="conversationChange()">
      </app-conversation-header>
      <mat-dialog-content *fsSkeletonForm="conversation">
        <div class="conversation-container overflow-shadow">
          <div class="conversation">
            <app-conversation-items
              [account]="account"
              [conversationService]="conversationService"
              [conversation]="conversation"
              [sessionConversationParticipant]="sessionConversationParticipant">
            </app-conversation-items>
          </div> 
        </div>
      </mat-dialog-content>
      <mat-dialog-actions>
        <div class="message-send-container">
          <div class="message-actions">
            <mat-form-field floatLabel="never">
              <textarea matInput (keydown)="messageKeydown($event)" cdkTextareaAutosize [(ngModel)]="message"
                [disabled]="conversation.state === ConversationState.Closed" name="message" placeholder="Type a message">
                    </textarea>
            </mat-form-field>
            <div class="buttons">
              <a 
                  mat-icon-button 
                  type="submit" 
                  [disabled]="!message || conversation.state === ConversationState.Closed"
                  color="primary">
                <mat-icon>send</mat-icon>
              </a>
              <fs-file 
                  [disabled]="conversation.state === ConversationState.Closed" (select)="fileSelect($event)"
                  [multiple]="true" 
                  imageWidth="1200" 
                  imageQuality=".8">
                <a 
                    mat-icon-button 
                    [disabled]="conversation.state === ConversationState.Closed" type="button"
                    color="basic">
                  <mat-icon>attach_file</mat-icon>
                </a>
              </fs-file>
              <button mat-button mat-dialog-close type="button">
                Close
              </button>
            </div>
          </div>

          <fs-file-previews [previewWidth]="100" [previewHeight]="100" [files]="files">
            <ng-template fs-file-preview-action placement="top-right" action="remove" tooltip="Remove">
              <mat-icon>close</mat-icon>
            </ng-template>
          </fs-file-previews>
        </div>
      </mat-dialog-actions>
    </ng-container>
  </form>
</fs-dialog>