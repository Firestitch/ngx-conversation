<ng-container *ngIf="conversation">
  <app-conversation-header
    [conversationService]="conversationService"
    [conversation]="conversation"
    (conversationChange)="conversationChange()">
  </app-conversation-header>
</ng-container>
<mat-dialog-content *fsSkeletonForm="conversation">
  <div class="conversation-container overflow-shadow">
    <div class="conversation">
      <app-conversation-items
        [account]="account"
        [conversationService]="conversationService"
        [conversation]="conversation"
        [sessionConversationParticipant]="sessionConversationParticipant">
      </app-conversation-items>
    </div> 
  </div>
  <div class="message-send-container">
    <form fsForm [submit]="messageSend" #messageForm>
      <div class="message-actions">
        <mat-form-field floatLabel="never">
          <textarea
            matInput
            (keydown)="messageKeydown($event)"
            cdkTextareaAutosize
            [(ngModel)]="message"
            [disabled]="conversation.state === ConversationState.Closed"
            name="message"
            placeholder="Type a message">
          </textarea>
        </mat-form-field>
        <div class="buttons">
          <button
              mat-icon-button
              type="submit"
              [disabled]="!message || conversation.state === ConversationState.Closed"
              color="primary">
            <mat-icon>send</mat-icon>
          </button>  
          <fs-file
              [disabled]="conversation.state === ConversationState.Closed"
              (select)="fileSelect($event)"
              [multiple]="true"
              imageWidth="1200"
              imageQuality=".8">
            <button
                mat-icon-button
                [disabled]="conversation.state === ConversationState.Closed"
                type="button"
                color="basic">
              <mat-icon>attach_file</mat-icon>
            </button> 
          </fs-file>
          <button 
              mat-button 
              mat-dialog-close 
              type="button">
            Close
          </button>
        </div>
      </div>

      <fs-file-previews 
          [previewWidth]="100"
          [previewHeight]="100"
          [files]="files">
        <ng-template fs-file-preview-action placement="top-right" action="remove" tooltip="Remove">
          <mat-icon>close</mat-icon>
        </ng-template>
      </fs-file-previews>
    </form>   
  </div> 
</mat-dialog-content>
